<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุญุฉ ุงูุชุญูู - System.as3g</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <h2><span class="special">system</span><span class="dot">.</span><span class="special">as3g</span></h2>
            </div>
            <div class="nav-actions">
                <span id="adminEmail" class="admin-email"></span>
                <button id="logoutBtn" class="btn-logout">ุชุณุฌูู ุงูุฎุฑูุฌ</button>
            </div>
        </div>
    </nav>

    <div class="dashboard-container">
        <div class="page-header">
            <h1>๐ ููุญุฉ ุงูุชุญูู</h1>
            <p>ุฅุฏุงุฑุฉ ุฃููุงุฏ ุงูุชูุนูู ูุงูุฃุฌูุฒุฉ ุงูููุนูุฉ</p>
        </div>

        <!-- Statistics Cards -->
        <div class="stats-grid">
            <div class="stat-card blue">
                <div class="stat-icon">๐ฆ</div>
                <div class="stat-info">
                    <h3 id="totalCodes">0</h3>
                    <p>ุฅุฌูุงูู ุงูุฃููุงุฏ</p>
                </div>
            </div>

            <div class="stat-card green">
                <div class="stat-icon">โ</div>
                <div class="stat-info">
                    <h3 id="usedCodes">0</h3>
                    <p>ุงูุฃููุงุฏ ุงููุณุชุฎุฏูุฉ</p>
                </div>
            </div>

            <div class="stat-card orange">
                <div class="stat-icon">๐ฑ</div>
                <div class="stat-info">
                    <h3 id="activeDevices">0</h3>
                    <p>ุงูุฃุฌูุฒุฉ ุงูููุนูุฉ</p>
                </div>
            </div>

            <div class="stat-card purple">
                <div class="stat-icon">๐ฏ</div>
                <div class="stat-info">
                    <h3 id="availableCodes">0</h3>
                    <p>ุฃููุงุฏ ูุชุงุญุฉ</p>
                </div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab-btn active" data-tab="codes">ุฃููุงุฏ ุงูุชูุนูู</button>
            <button class="tab-btn" data-tab="devices">ุงูุฃุฌูุฒุฉ ุงูููุนูุฉ</button>
            <button class="tab-btn" data-tab="reports">๐ ุงูุชูุงุฑูุฑ</button>
        </div>

        <!-- Codes Tab -->
        <div id="codesTab" class="tab-content active">
            <div class="section-header">
                <h2>ุฅุฏุงุฑุฉ ุฃููุงุฏ ุงูุชูุนูู</h2>
                <button id="generateCodeBtn" class="btn-primary">โ ุฅูุดุงุก ููุฏ ุฌุฏูุฏ</button>
            </div>

            <div id="codesTable" class="data-table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ุงูููุฏ</th>
                            <th>ุงุณู ุงูุนููู</th>
                            <th>ุงูููุงู</th>
                            <th>ุงูุชููููู</th>
                            <th>ุงููุณุฎุฉ</th>
                            <th>ุงูุญุงูุฉ</th>
                            <th>ุงููุฏุฉ (ููู)</th>
                            <th>ุชุงุฑูุฎ ุงูุชูุนูู</th>
                            <th>ุงูุฅุฌุฑุงุกุงุช</th>
                        </tr>
                    </thead>
                    <tbody id="codesTableBody">
                        <tr>
                            <td colspan="6" class="loading">ุฌุงุฑู ุงูุชุญููู...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Devices Tab -->
        <div id="devicesTab" class="tab-content">
            <div class="section-header">
                <h2>ุงูุฃุฌูุฒุฉ ุงูููุนูุฉ</h2>
                <div class="header-actions">
                    <button class="btn-secondary" onclick="fixDeviceNames()" title="ุฅุนุงุฏุฉ ุชุณููุฉ ุงูุฃุฌูุฒุฉ ุจุดูู ูุชุณูุณู">๐๏ธ
                        ุชุตุญูุญ ุงูุฃุณูุงุก</button>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="devices-stats-grid">
                <div class="mini-stat-card blue">
                    <div class="mini-stat-icon">โ</div>
                    <div class="mini-stat-info">
                        <h4 id="activeDevicesCount">0</h4>
                        <p>ุฃุฌูุฒุฉ ูุดุทุฉ</p>
                    </div>
                </div>
                <div class="mini-stat-card orange">
                    <div class="mini-stat-icon">โธ๏ธ</div>
                    <div class="mini-stat-info">
                        <h4 id="stoppedDevicesCount">0</h4>
                        <p>ุฃุฌูุฒุฉ ูุชูููุฉ</p>
                    </div>
                </div>
                <div class="mini-stat-card red">
                    <div class="mini-stat-icon">โ</div>
                    <div class="mini-stat-info">
                        <h4 id="expiredDevicesCount">0</h4>
                        <p>ุฃุฌูุฒุฉ ููุชููุฉ</p>
                    </div>
                </div>
                <div class="mini-stat-card purple">
                    <div class="mini-stat-icon">๐</div>
                    <div class="mini-stat-info">
                        <h4 id="avgDaysLeft">0</h4>
                        <p>ูุชูุณุท ุงูุฃูุงู ุงููุชุจููุฉ</p>
                    </div>
                </div>
            </div>

            <!-- Search and Filter Bar -->
            <div class="devices-toolbar">
                <div class="search-box">
                    <input type="text" id="devicesSearch" placeholder="๐ ุงุจุญุซ ุนู ุฌูุงุฒ ุฃู ููุฏ..." />
                </div>
                <div class="filter-buttons">
                    <button class="filter-btn active" data-filter="all">ุงููู</button>
                    <button class="filter-btn" data-filter="active">ูุดุท</button>
                    <button class="filter-btn" data-filter="stopped">ูุชููู</button>
                    <button class="filter-btn" data-filter="expired">ููุชูู</button>
                </div>
                <div class="sort-buttons">
                    <select id="devicesSort" class="sort-select">
                        <option value="activatedAt-desc">ุงูุฃุญุฏุซ ุชูุนููุงู</option>
                        <option value="activatedAt-asc">ุงูุฃูุฏู ุชูุนููุงู</option>
                        <option value="expiresAt-asc">ุงูุฃูุฑุจ ุงูุชูุงุกู</option>
                        <option value="expiresAt-desc">ุงูุฃุจุนุฏ ุงูุชูุงุกู</option>
                        <option value="daysLeft-asc">ุฃูู ุฃูุงู ูุชุจููุฉ</option>
                        <option value="daysLeft-desc">ุฃูุซุฑ ุฃูุงู ูุชุจููุฉ</option>
                        <option value="deviceName-asc">ุงูุงุณู (ุฃ-ู)</option>
                        <option value="deviceName-desc">ุงูุงุณู (ู-ุฃ)</option>
                    </select>
                </div>
            </div>

            <!-- Bulk Actions Bar -->
            <div class="bulk-actions-bar" id="bulkActionsBar" style="display: none;">
                <div class="selected-count">
                    <span id="selectedCount">0</span> ุฌูุงุฒ ูุญุฏุฏ
                </div>
                <div class="bulk-buttons">
                    <button class="bulk-btn bulk-start" onclick="bulkStartDevices()">โถ๏ธ ุชุดุบูู ุงููู</button>
                    <button class="bulk-btn bulk-stop" onclick="bulkStopDevices()">โธ๏ธ ุฅููุงู ุงููู</button>
                    <button class="bulk-btn bulk-delete" onclick="bulkDeleteDevices()">๐๏ธ ุญุฐู ุงููู</button>
                    <button class="bulk-btn bulk-export" onclick="exportSelectedDevices()">๐ฅ ุชุตุฏูุฑ ุงููุญุฏุฏ</button>
                </div>
            </div>

            <div id="devicesTable" class="data-table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th><input type="checkbox" id="selectAllDevices" /></th>
                            <th style="width: 50px;">#</th>
                            <th>ุงุณู ุงูุฌูุงุฒ</th>
                            <th>ููุฏ ุงูุชูุนูู</th>
                            <th>ุชุงุฑูุฎ ุงูุชูุนูู</th>
                            <th>ุชุงุฑูุฎ ุงูุงูุชูุงุก</th>
                            <th>ุงูุญุงูุฉ</th>
                            <th>ุงูุฅุฌุฑุงุกุงุช</th>
                        </tr>
                    </thead>
                    <tbody id="devicesTableBody">
                        <tr>
                            <td colspan="7" class="loading">ุฌุงุฑู ุงูุชุญููู...</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Export All Button -->
            <div class="export-section">
                <button class="btn-primary" onclick="exportAllDevices()">๐ฅ ุชุตุฏูุฑ ุฌููุน ุงูุฃุฌูุฒุฉ</button>
            </div>
        </div>

        <!-- Reports Tab (Activity Logs) -->
        <div id="reportsTab" class="tab-content">
            <div class="section-header">
                <h2>ุณุฌู ุงููุดุงุทุงุช (Activity Logs)</h2>
            </div>

            <!-- Logs Filter Bar -->
            <div class="devices-toolbar" style="margin-bottom: 20px;">
                <div class="filter-group" style="display: flex; gap: 10px; flex-wrap: wrap; flex: 1;">
                    <input type="date" id="logDateFrom" class="form-control"
                        style="padding: 8px; border-radius: 8px; border: 1px solid #ddd;">
                    <input type="date" id="logDateTo" class="form-control"
                        style="padding: 8px; border-radius: 8px; border: 1px solid #ddd;">
                    <input type="text" id="logAdminFilter" placeholder="ุจุญุซ ุจุญุณุงุจ ุงูุฃุฏูู..."
                        style="padding: 8px; border-radius: 8px; border: 1px solid #ddd; min-width: 200px;">
                    <select id="logActionFilter" style="padding: 8px; border-radius: 8px; border: 1px solid #ddd;">
                        <option value="all">ูู ุงูุฅุฌุฑุงุกุงุช</option>
                        <option value="ุฅูุดุงุก ุฃููุงุฏ">ุฅูุดุงุก ุฃููุงุฏ</option>
                        <option value="ุญุฐู ููุฏ">ุญุฐู ููุฏ</option>
                        <option value="ุฅููุงู ุณูุณุชู">ุฅููุงู ุณูุณุชู</option>
                        <option value="ุชุดุบูู ุณูุณุชู">ุชุดุบูู ุณูุณุชู</option>
                        <option value="ุญุฐู ุณูุณุชู">ุญุฐู ุณูุณุชู</option>
                    </select>
                    <button id="applyLogFilters" class="btn-primary" style="padding: 8px 20px;">ุชุทุจูู ุงูููุชุฑ</button>
                </div>
            </div>

            <div class="data-table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ุงูุชุงุฑูุฎ / ุงูููุช</th>
                            <th>ุญุณุงุจ ุงูุฃุฏูู</th>
                            <th>ููุน ุงูุฅุฌุฑุงุก</th>
                            <th>ุงูุชูุงุตูู</th>
                        </tr>
                    </thead>
                    <tbody id="reportsTableBody">
                        <tr>
                            <td colspan="4" class="loading">ุฌุงุฑู ุชุญููู ุงูุณุฌู...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Generate Code Modal -->
    <div id="generateModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>ุฅูุดุงุก ููุฏ ุชูุนูู ุฌุฏูุฏ</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="customerName">ุงุณู ุงูุนููู *</label>
                    <input type="text" id="customerName" placeholder="ุฃุฏุฎู ุงุณู ุงูุนููู" required>
                </div>
                <div class="form-group">
                    <label for="customerLocation">ุงุณู ุงูููุงู/ุงููุฑุน *</label>
                    <input type="text" id="customerLocation" placeholder="ูุซุงู: ูุฑุน ุงููุนุงุฏู" required>
                </div>
                <div class="form-group">
                    <label for="customerPhone">ุฑูู ุงูุชููููู *</label>
                    <input type="tel" id="customerPhone" placeholder="01XXXXXXXXX" required>
                </div>
                <div class="form-group">
                    <label for="versionType">ูุณุฎุฉ ุงูุจุฑูุงูุฌ *</label>
                    <select id="versionType" class="form-control"
                        style="width: 100%; padding: 12px; border-radius: 10px; border: 1px solid rgba(0,0,0,0.1);">
                        <option value="offline" selected>ูุณุฎุฉ ุฃูููุงูู (Offline)</option>
                        <option value="online">ูุณุฎุฉ ุฃูููุงูู (Online)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ูุฏุฉ ุงูุงุดุชุฑุงู</label>
                    <div style="display: flex; gap: 15px; align-items: center; margin-bottom: 10px;">
                        <input type="checkbox" id="isLifetime" style="width: 20px; height: 20px;">
                        <label for="isLifetime" style="margin: 0; cursor: pointer;">ูุฏู ุงูุญูุงุฉ (Lifetime)</label>
                    </div>
                    <input type="number" id="codeDuration" value="30" min="1" max="365" class="form-control">
                </div>
                <div class="form-group">
                    <label for="codeCount">ุนุฏุฏ ุงูุฃููุงุฏ ุงููุทููุจุฉ</label>
                    <input type="number" id="codeCount" value="1" min="1" max="10">
                </div>
            </div>
            <div class="modal-footer">
                <button id="confirmGenerateBtn" class="btn-primary">ุฅูุดุงุก</button>
                <button class="btn-secondary close-modal">ุฅูุบุงุก</button>
            </div>
        </div>
    </div>

    <!-- Firebase -->
    <script type="module" src="firebase-config.js"></script>
    <script type="module" src="dashboard.js"></script>
</body>

</html>